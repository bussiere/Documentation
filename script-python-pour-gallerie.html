<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8">
        <title>Script python pour gallerie</title>
        <link rel="stylesheet" href="http://bussiere.github.com/Documentation/theme/css/main.css">
                <link href="http://bussiere.github.com/Documentation/feeds\all.atom.xml" type="application/atom+xml" rel="alternate" title="Documentation diverses Atom Feed" />
                
        <!--[if IE]>
            <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="http://bussiere.github.com/Documentation/">Documentation diverses </a></h1>
                <nav><ul>
                                                                                    <li ><a href="http://bussiere.github.com/Documentation/category/blog.html">Blog</a></li>
                                    <li class="active"><a href="http://bussiere.github.com/Documentation/category/geek.html">Geek</a></li>
                                                </ul></nav>
        </header><!-- /#banner -->
        <section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="http://bussiere.github.com/Documentation/script-python-pour-gallerie.html" rel="bookmark"
           title="Permalink to Script python pour gallerie">Script python pour gallerie</a></h1>
          </header>

    <div class="entry-content">
      <footer class="post-info">
        <abbr class="published" title="2013-07-15T00:00:00">
                lun. 15 juillet 2013
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="http://bussiere.github.com/Documentation/author/bussiere.html">Bussiere</a>
        </address>
        <p>In <a href="http://bussiere.github.com/Documentation/category/geek.html">Geek</a>. </p>
<p>tags: <a href="http://bussiere.github.com/Documentation/tag/python.html">python</a><a href="http://bussiere.github.com/Documentation/tag/website.html">website</a><a href="http://bussiere.github.com/Documentation/tag/gallerie.html">gallerie</a><a href="http://bussiere.github.com/Documentation/tag/script.html">script</a><a href="http://bussiere.github.com/Documentation/tag/html.html">html</a></p>
</footer><!-- /.post-info -->      <p>Un petit script en python pour generer une gallerie statique a partir d'image.
Avec les images encod√©es dans la page html.</p>
<p>:::python
    import os
    path="."  # insert the path to the directory of interest
    dirList=os.listdir(path)
    import re
    import base64
    def tryint(s):
        try:
            return int(s)
        except:
            return s</p>
<div class="highlight"><pre><span class="nx">def</span> <span class="nx">alphanum_key</span><span class="p">(</span><span class="nb">s</span><span class="p">):</span>
    <span class="s2">&quot;&quot;&quot; Turn a string into a list of string and number chunks.</span>
<span class="s2">        &quot;</span><span class="nx">z23a</span><span class="s2">&quot; -&gt; [&quot;</span><span class="nb">z</span><span class="s2">&quot;, 23, &quot;</span><span class="nx">a</span><span class="s2">&quot;]</span>
<span class="s2">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="err">[</span> <span class="nx">tryint</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="nb">for</span> <span class="n">c</span> <span class="k">in</span> <span class="nx">re.split</span><span class="p">(</span><span class="s1">&#39;([0-9]+)&#39;</span><span class="p">,</span> <span class="nb">s</span><span class="p">)</span> <span class="cp">]</span>

dirList.sort(key=alphanum_key)

def writeindex(compteur,stri,taille):
    plusun = compteur + 1
    moinsun = compteur - 1
    moinsun = str(moinsun)
    if compteur == 0 :
        filef = open(&#39;index.html&#39;, &#39;w&#39;)
        moinsun = &quot;index.html&quot;
    else :
        if compteur == taille - 1 :
            plusun = compteur
        filef = open(&#39;%d.html&#39;%compteur, &#39;w&#39;)


    filef.write(&quot;<span class="nt">&lt;html&gt;&lt;body&gt;&lt;center&gt;</span>\r\n&quot;)
    filef.write(&quot;<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&#39;http://shiniez.deviantart.com/&#39;</span><span class="nt">&gt;</span>http://shiniez.deviantart.com/<span class="nt">&lt;/a&gt;&lt;br&gt;</span>\r\n&quot;)
    filef.write(&quot;<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&#39;index.html&#39;</span><span class="nt">&gt;</span><span class="err">&lt;&lt;</span><span class="nt">&lt;/a&gt;</span><span class="ni">&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;</span><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&#39;%s.html&#39;</span><span class="nt">&gt;</span><span class="err">&lt;</span><span class="nt">&lt;/a&gt;</span><span class="ni">&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;</span><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&#39;%d.html&#39;</span><span class="nt">&gt;</span>&gt;<span class="nt">&lt;/a&gt;</span><span class="ni">&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;</span><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&#39;%d.html&#39;</span><span class="nt">&gt;</span>&gt;&gt;<span class="nt">&lt;/a&gt;&lt;br&gt;</span>\r\n&quot;%(moinsun,plusun,taille-1))
    filef.write(&quot;<span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">&#39;data:image/jpg;base64,%s&#39;</span><span class="nt">&gt;&lt;br&gt;</span>\r\n&quot;%stri)
    stri = &quot;&quot;
    filef.write(&quot;<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&#39;index.html&#39;</span><span class="nt">&gt;</span><span class="err">&lt;&lt;</span><span class="nt">&lt;/a&gt;</span><span class="ni">&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;</span><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&#39;%s.html&#39;</span><span class="nt">&gt;</span><span class="err">&lt;</span><span class="nt">&lt;/a&gt;</span><span class="ni">&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;</span><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&#39;%d.html&#39;</span><span class="nt">&gt;</span>&gt;<span class="nt">&lt;/a&gt;</span><span class="ni">&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;</span><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&#39;%d.html&#39;</span><span class="nt">&gt;</span>&gt;&gt;<span class="nt">&lt;/a&gt;&lt;br&gt;</span>\r\n&quot;%(moinsun,plusun,taille-1))
    filef.write(&quot;<span class="nt">&lt;center&gt;&lt;/body&gt;&lt;/html&gt;</span>\r\n&quot;)

    filef.close()

compteur = 0
listimg = <span class="cp">[]</span>
for fname in dirList:
    if &quot;jpg&quot; in fname :
        listimg.append(fname)

taille = len(listimg)
for img in listimg :
            image_file = open(img, &quot;rb&quot;)
            stri = base64.b64encode(image_file.read())
            image_file.close()

            writeindex(compteur,stri,taille)
            compteur += 1
            stri = &quot;&quot;
</pre></div>
    </div><!-- /.entry-content -->
    
  </article>
</section>
        <section id="extras" class="body">
                        <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                                                    <li><a href="http://docs.notmyidea.org/alexis/pelican/">Pelican</a></li>
                                                    <li><a href="http://python.org">Python.org</a></li>
                                                    <li><a href="http://jinja.pocoo.org">Jinja2</a></li>
                                                </ul>
                </div><!-- /.blogroll -->
                                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="http://bussiere.github.com/Documentation/feeds\all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>
                            
                                                    <li><a href="https://github.com/bussiere">Bussiere</a></li>
                                                </ul>
                </div><!-- /.social -->
                </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>